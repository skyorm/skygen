# skygen

A command line tool to generate [skyorm](https://github.com/skyorm/skyorm) code. Deeply inspired
by [reform](https://github.com/go-reform/reform) orm generator.

## Installation

```bash
go install github.com/skyorm/skygen
```

## Instructions

To generate Model implementation for a struct:

- Put `go:generate skygen` to the file header;
- Mark the `struct` with `// skygen:{table_name}` comment;
- Mark the properties with `sky:"{field_name}"` tag;
- Run `go generate`;

## Sample

`sample.go`
```go
//go:generate skygen
package sample

// User struct.
// sky:users
type User struct {
	ID   uint64 `sky:"id,pk"`
	Name string `sky:"name"`
}
```

After running `go generate`, a new file with `_sky.go` extension will be created with the following contents:

`sample_sky.go`
```go
// Code generated by github.com/skyorm/skygen. DO NOT EDIT.
package sample

import (
	"github.com/skyorm/skyorm"
)

var (
	// UserStore represents skyorm.Store for User struct.
	UserStore = skyorm.NewStore(
		"users",
		0,
		func() skyorm.Model { return new(User) },
		skyorm.NewProp("id", "uint64", true),
		skyorm.NewProp("name", "string", false),
	)
)

// OrmStore implements skyorm.Store interface.
func (m *User) OrmStore() skyorm.Store {
	return UserStore
}

// OrmPk implements skyorm.Store interface.
func (m *User) OrmPk() interface{} {
	return m.ID
}

// OrmPkPointer implements skyorm.Store interface.
func (m *User) OrmPkPointer() interface{} {
	return &m.ID
}

// OrmPkProp implements skyorm.Store interface.
func (m *User) OrmPkProp() skyorm.Prop {
	return UserStore.Pk()
}

// OrmProps implements skyorm.Store interface.
func (m *User) OrmProps() []skyorm.Prop {
	return UserStore.Props()
}

// OrmPointers implements skyorm.Store interface.
func (m *User) OrmPointers() []interface{} {
	return []interface{}{
		&m.ID,
		&m.Name,
	}
}

// OrmVals implements skyorm.Store interface.
func (m *User) OrmVals() []interface{} {
	return []interface{}{
		m.ID,
		m.Name,
	}
}

// IDProp returns skyorm.Prop for m.ID field.
func (m *User) IDProp() skyorm.Prop {
	return m.OrmProps()[0]
}

// NameProp returns skyorm.Prop for m.Name field.
func (m *User) NameProp() skyorm.Prop {
	return m.OrmProps()[1]
}
```